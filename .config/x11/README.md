Updated from larbs d8a8970715070f73bcb6333e3fe851b6802ac702 and adapted to my existing files.
